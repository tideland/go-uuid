# golangci-lint configuration for Tideland Go UUID
# This is a complete example configuration that would work with actual golangci-lint runs
# (without the restrictive schema validation)

version: "2"

run:
  timeout: 5m
  tests: true
  modules-download-mode: readonly
  skip-dirs:
    - vendor
    - .git
  skip-files:
    - ".*\\.pb\\.go$"

linters:
  enable:
    - errcheck # Check for unchecked errors
    - gosimple # Simplify code
    - govet # Report suspicious constructs
    - ineffassign # Detect ineffectual assignments
    - staticcheck # Static analysis checks
    - unused # Check for unused code
    - gofmt # Check code formatting
    - goimports # Check import formatting
    - misspell # Check for misspelled words
    - gocritic # Comprehensive Go linter
    - revive # Fast, configurable, extensible linter
    - stylecheck # Replacement for golint
    - gosec # Security analysis
    - unconvert # Remove unnecessary type conversions
    - prealloc # Check for slice preallocation
    - exportloopref # Check for loop variable capture
  disable:
    - structcheck # Deprecated linter
    - deadcode # Deprecated linter
    - varcheck # Deprecated linter
    - maligned # Deprecated linter
    - interfacer # Deprecated linter
    - scopelint # Deprecated linter

linters-settings:
  errcheck:
    check-blank: true
    check-type-assertions: true
    exclude-functions:
      - fmt.Print
      - fmt.Println
      - fmt.Printf

  govet:
    enable-all: true
    disable:
      - shadow # Too many false positives
      - fieldalignment # Too pedantic for this project

  gofmt:
    simplify: true

  goimports:
    local-prefixes: github.com/tideland/go-uuid

  gocritic:
    enabled-tags:
      - diagnostic
      - style
      - performance
      - experimental
    disabled-checks:
      - commentFormatting
      - whyNoLint
      - unnamedResult
    settings:
      hugeParam:
        sizeThreshold: 256
      rangeValCopy:
        sizeThreshold: 512

  revive:
    severity: warning
    rules:
      - name: exported
        arguments:
          - disableStutteringCheck
      - name: package-comments
        disabled: true
      - name: comment-spacings
      - name: dot-imports
        disabled: true
      - name: blank-imports
      - name: unused-parameter
        disabled: true

  stylecheck:
    checks: ["all", "-ST1003", "-ST1016"] # Disable underscores in names and receiver naming

  gosec:
    severity: medium
    confidence: medium
    excludes:
      - G204 # Subprocess with variable
    config:
      G306: "0644"

  staticcheck:
    checks: ["all"]

  unused:
    check-exported: false

  misspell:
    locale: US
    ignore-words:
      - uuid
      - uuids

issues:
  exclude-rules:
    # Exclude some linters from running on test files
    - path: _test\.go
      linters:
        - errcheck
        - gocritic
        - gosec
        - ineffassign
    # Exclude some linters from running on example files
    - path: example_.*\.go
      linters:
        - errcheck
        - unused
    # Ignore certain govet reports for UUID struct fields
    - linters:
        - govet
      text: "struct field .* should be .*"
      path: uuid\.go
    # Ignore long lines in comments
    - linters:
        - revive
      text: "line-length-limit"
      source: "^\\s*//.*$"

  exclude:
    # Exclude specific patterns
    - "Error return value of .((os\\.)?std(out|err)\\..*|.*Close|.*Flush|os\\.Remove(All)?|.*printf?|os\\.(Un)?Setenv). is not checked"
    - "should have a package comment, unless it's in another file for this package"

  # Maximum issues count per one linter
  max-issues-per-linter: 0

  # Maximum count of issues with the same text
  max-same-issues: 0

  # Show only new issues created after git revision
  # new-from-rev: HEAD

  # Fix found issues (if it's supported by the linter)
  fix: false

output:
  format: colored-line-number
  print-issued-lines: true
  print-linter-name: true
  uniq-by-line: true
  sort-results: true

severity:
  default-severity: error
  case-sensitive: false
  rules:
    - linters:
        - revive
      severity: warning
